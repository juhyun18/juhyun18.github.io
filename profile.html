<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>judy's homepage</title>
    <style type="text/css">
        @font-face {
            font-family: 'dongBrush';
            src: url("DungGeunMo.ttf");
        }
        body{ margin: 0; padding: 0;}
        ul, li{ list-style: none;}
        a{ text-decoration: none;}

        .wrap{ overflow: scroll; margin: 100px auto; width: 500px; height: 600px; background: rgb(177, 176, 176);}
        .header{ display: flex; 
            align-items: center;
             justify-content: space-between;
              background: blue; 
              box-shadow: inset 2px 2px  white;
                border-bottom: 2px solid black;    
                border-top: 1px solid black;
                border-left: 1px solid black;
                border-right: 1px solid black;
        }
        .header { height: 50px; line-height: 50px; font-size: 20px;}
        .header_btn a{ color: white; display: inline-block; margin-right: 10px; font-size: 10px; text-shadow: 2px 3px 0 black; }
        
        .wrap_top{ border-bottom: 1px solid black; text-shadow: 0px 1px 0 white;}
        .menu{ display: flex; padding-left: 0;}
        .menu li{ width: 100px; height: 30px; line-height: 30px; text-align: center;}
        .menu li a{ display: block; color : #292929;}
        .menu li a:hover{ color: #fff; text-decoration: underline;}

        .profile{ width: 90%; padding-top: 30px; display: flex; justify-content: space-around;}
        .profile_img{ width: 100px; height: 120px; border: 1px solid black; transform: scale(1); }

        .info p{ margin: 0 0 15px 0;}
        .talk p{margin-left: 50px; margin-top: 30px; 
            text-shadow: 1px 1px 0 white ;
            font-size: 15pt;
        }
    </style>
    
</head>

<body bgcolor="black" style="font-family: dongBrush;">
    <div class="wrap">
        <div class="header">
            <b style="text-shadow: 1px 1px 0 white;">&nbsp; judy's profile</b>
            <div class="header_btn">
                <span><a href="#"><b>__</b></a></span>
                <span><a href="#"><b>â–¡</b></a></span>
                <span><a href="#"><b>â…©</b></a></span>
            </div>
        </div>
        
        <div class="wrap_top">
            <div class="gnb">
                <ul class="menu">
                    <li><a href="profile.html"><ins>P</ins>rofile</a></li>
                    <li><a href="hobby.html"><ins>H</ins>obby</a></li>
                    <li><a href="roadmap.html"><ins>R</ins>oadMap</a></li>
                    <li><a href="signup.html"><ins>S</ins>ign up</a></li>
                    <li><a href="index.html"><ins>L</ins>ogout</a></li>
                </ul>
            </div>
        </div>

        <div class="profile">
            <div class="img">
                <img class="profile_img" src="image\judy.jpg" >
            </div>
            <div class="info">
                <p>ğŸ‘©ğŸ» í™© ì£¼í˜„</p>
                <p>ğŸ’Œ wngus_0896@naver.com</p>
                <p>ì¢Œìš°ëª… : í›„íšŒí•˜ì§€ ë§ì</p>
                <p>ì „ê³µ : ì •ë³´í†µì‹ ê³µí•™ê³¼</p>
                <p>ì§„ë¡œí¬ë§ : ì›¹ê°œë°œì</p>
            </div>
        </div>
        <div class="talk">
            <p><b>ë°°ì›€ì— ìˆì–´ ë”ë””ê³  ëª¨ìë¥´ì§€ë§Œ <br>
                í¬ê¸°í•˜ì§€ ì•ŠëŠ” ì˜ì§€ë¡œ ì—´ì‹¬íˆ í•˜ê² ìŠµë‹ˆë‹¤.</b></p>
        </div>
        <br><br>
        
        <form action="javascript:saveGuestbook();" name="guestbookFrm">
            <legend>ì¼ì´Œí‰ğŸ¾</legend>
            <table style="border: 2px dotted #000; padding: 2px; width: 100%; padding: 3px 10px;">
                <tr>
                    <th style="font-size: 10px;"><label for="username">ë‹‰ë„¤ì„</label></th>
                    <td><input type="text" name="username" id="username"></td>
                    <th style="font-size: 10px;"><label for="content">ë‚´ìš©</label></th>
                    <td><input type="text" name="content" id="content"></td>
                    <th colspan="2">
                        <input type="submit" value="ì €ì¥" class="save">
                    </th>
                </tr>
            </table>
        </form>
        <table id="tbl-guestbook">
            <thead>
                <tr>
                    <th>ì´ë¦„</th>
                    <th>ë‚´ìš©</th>
                    <th>ì¼ì‹œ</th>
                </tr>
            </thead>
            <tbody></tbody>
        </table>
        <style>
        .save{
            border: 2px dashed black; 
          background-color: rgb(153, 153, 153); 
          box-shadow: inset 2px 2px white;
          font-family: dongBrush;
        }
        #tbl-guestbook {
            
            margin: 5px 0;
            border: 1px dotted #000;
            border-collapse: collapse;
            width: 100%;
        }
        #tbl-guestbook th, #tbl-guestbook td {
            border: 1px dotted #000;
            padding: 1px;
        }
        </style>
        <script>
        class Guestbook {
            constructor(username, content, datetime = Date.now()){
                this.username = username;
                this.content = content;
                this.datetime = datetime;
            }
        }
    
        /**
         * submití•¸ë“¤ëŸ¬ - ìœ íš¨ì„±ê²€ì‚¬
         */
        document.guestbookFrm.addEventListener('submit', (e) => {
            if(!username.value){
                alert("ì´ë¦„ì„ ì…ë ¥í•´ì£¼ì„¸ìš”.");
                e.preventDefault();
                return;
            }
            if(!content.value){
                alert("ë‚´ìš©ì„ ì…ë ¥í•´ì£¼ì„¸ìš”.");
                e.preventDefault();
                return;
            }
        });
    
        /**
         * í¼ì œì¶œ - localStorageì— ì €ì¥
         */ 
        const saveGuestbook = () => {
            // 1. guestbookê°ì²´ ìƒì„±
            const guestbook = new Guestbook(username.value, content.value);
            console.log(guestbook);
    
            // 2. ë°°ì—´ì— ì¶”ê°€
            const guestbooks = JSON.parse(localStorage.getItem('guestbooks')) || [];
            guestbooks.push(guestbook);
            console.log(guestbooks);
    
            // 3. localStorageì— ì €ì¥
            localStorage.setItem('guestbooks', JSON.stringify(guestbooks));
    
            // 4. ì´ˆê¸°í™”
            document.guestbookFrm.reset();
    
            // 5. ë°©ëª…ë¡ ë Œë”ë§
            renderGuestbook(guestbooks);
        };
    
        const datetimeFormatter = (date) => {
            const f = (n) => n >= 10 ? n : "0" + n;
            const MM = f(date.getMonth() + 1);
            const dd = f(date.getDate());
            const HH = f(date.getHours());
            const mm = f(date.getMinutes());
    
            return `${MM}/${dd} ${HH}:${mm}`;
        }
    
        const renderGuestbook = (guestbooks = JSON.parse(localStorage.getItem('guestbooks'))) => {
            const tbody = document.querySelector("#tbl-guestbook tbody");
            tbody.innerHTML = ""; // ê¸°ì¡´ì½”ë“œ ì œê±°
    
            // optional chaining ?. ì•ì˜ ë³€ìˆ˜ê°€ undefined/nullì¼ë•Œë„ ì˜¤ë¥˜ë¥¼ ìœ ë°œí•˜ì§€ ì•ŠìŒ.
            guestbooks?.reverse(); // ì—­ìˆœì •ë ¬
            
            if(guestbooks){
                guestbooks.forEach(({username, content, datetime}, index) => {
                    tbody.innerHTML += `
                    <tr>
                        
                        <td>${username}</td>
                        <td>${content}</td>
                        <td>${datetimeFormatter(new Date(datetime))}</td>
                    </tr>
                    `;
                });
            }
            else {
                tbody.innerHTML = '<tr><td colspan="4" style="text-align: center;">ë“±ë¡ëœ ë°©ëª…ë¡ì´ ì—†ìŠµë‹ˆë‹¤.</td></tr>';
            }
        }
        </script>
        
    </div>
</body>
</html>